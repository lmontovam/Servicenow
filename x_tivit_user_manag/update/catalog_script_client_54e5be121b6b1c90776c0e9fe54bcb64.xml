<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="catalog_script_client">
    <catalog_script_client action="INSERT_OR_UPDATE">
        <active>true</active>
        <applies_catalog>true</applies_catalog>
        <applies_extended>false</applies_extended>
        <applies_req_item>false</applies_req_item>
        <applies_sc_task>false</applies_sc_task>
        <applies_target_record>false</applies_target_record>
        <applies_to>item</applies_to>
        <cat_item display_value="Gestão de Usuário">186971c51b5e1810776c0e9fe54bcbdd</cat_item>
        <cat_variable>IO:d2c72ab81b5f1cd0f47667853a4bcb94</cat_variable>
        <condition/>
        <description/>
        <field/>
        <global>true</global>
        <isolate_script>true</isolate_script>
        <messages/>
        <name>08_Troca_Destino</name>
        <order/>
        <script><![CDATA[function onChange(control, oldValue, newValue, isLoading) {
	g_form.clearValue('licenca_destino');
	g_form.setMandatory('remove',false);
	g_form.setDisplay('remove',false);
	g_form.setMandatory('license_remove',false);
	g_form.setDisplay('license_remove',false);
	g_form.clearOptions('license_remove');
	if (isLoading || newValue == '') {
      return;
   }

	var ga = new GlideAjax("x_tivit_user_manag.AjaxUtils");
	ga.addParam('sysparm_name','getRoles');
	ga.addParam('user', newValue);
	ga.getXML(ajaxResponse);

}

function ajaxResponse(serverResponse){
	
	var parm = serverResponse.responseXML.getElementsByTagName("Parm");
		
	for(var i = 0; i < parm.length; i ++) { 
		var name = parm[i].getAttribute("name");
		var value = parm[i].getAttribute("value");
		
		if(value != g_form.getValue('licenca_origem')){
		
			if(value !=  'null'){
				g_form.setValue('licenca_destino',value);
				if(value == 'Aprovador'){
					
					//g_form.addOption('license_remove','','--None--');
					g_form.addOption('license_remove','Solicitante','Solicitante');
					g_form.addOption('license_remove','Aprovador','Aprovador');
					
					g_form.setDisplay('remove',true);
					g_form.setMandatory('remove',true);
					g_form.setDisplay('license_remove',true);
					g_form.setMandatory('license_remove',true);
					
				}else if(value == 'Solucionador') {
					
					//g_form.addOption('license_remove','','--None--');
					g_form.addOption('license_remove','Solicitante','Solicitante');
					g_form.addOption('license_remove','Solucionador','Solucionador');
					
					g_form.setDisplay('remove',true);
					g_form.setMandatory('remove',true);
					g_form.setDisplay('license_remove',true);
					g_form.setMandatory('license_remove',true);
					
				}
			}			
		}else{
			g_form.addErrorMessage('Licença de destino igual a licença de origem!!');
			g_form.clearValue('user_add');
		}
	}
		
}]]></script>
        <sys_class_name>catalog_script_client</sys_class_name>
        <sys_created_by>leandro.monteiro@tivit.com</sys_created_by>
        <sys_created_on>2020-10-01 19:50:20</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>54e5be121b6b1c90776c0e9fe54bcb64</sys_id>
        <sys_mod_count>19</sys_mod_count>
        <sys_name>08_Troca_Destino</sys_name>
        <sys_overrides/>
        <sys_package display_value="User Management" source="x_tivit_user_manag">704931851b5e1810776c0e9fe54bcbde</sys_package>
        <sys_policy/>
        <sys_scope display_value="User Management">704931851b5e1810776c0e9fe54bcbde</sys_scope>
        <sys_update_name>catalog_script_client_54e5be121b6b1c90776c0e9fe54bcb64</sys_update_name>
        <sys_updated_by>leandro.monteiro@tivit.com</sys_updated_by>
        <sys_updated_on>2020-10-02 18:49:40</sys_updated_on>
        <table/>
        <type>onChange</type>
        <ui_type>1</ui_type>
        <variable_set/>
        <view/>
    </catalog_script_client>
</record_update>
